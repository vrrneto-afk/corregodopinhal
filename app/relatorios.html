<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relat√≥rios ‚Äì S√≠tio C√≥rrego do Pinhal</title>

<link rel="manifest" href="../manifest.json">
<meta name="theme-color" content="#7b3f2a">

<!-- MENU GLOBAL -->
<link rel="stylesheet" href="../menu/menu.css">

<!-- üî• FIREBASE (OFICIAL ‚Äì OBRIGAT√ìRIO) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCW-CuFDrOLO-dteckl_GrPTocmyS-IrzY",
  authDomain: "sitio-corrego-do-pinhal.firebaseapp.com",
  projectId: "sitio-corrego-do-pinhal"
});
</script>

<!-- üîê PERMISS√ïES (L√ìGICA GLOBAL) -->
<script src="../menu/menu-permissoes.js"></script>

<!-- IDENTIFICA√á√ÉO DA P√ÅGINA -->
<script>
window.PERMISSAO_PAGINA = {
  area: "app",
  chave: "relatorios"
};
</script>

<!-- üîí AUTH GUARD (CARREGAR UMA √öNICA VEZ) -->
<script src="../login/auth-guard.js"></script>

<style>
:root{
  --marrom:#7b3f2a;
  --bege:#f6efe7;
  --cinza:#666;
  --logo:#D0B485;
}
*{ box-sizing:border-box; font-family:Inter,system-ui,Arial; }
body{ margin:0; background:var(--bege); color:#333; display:none; }
header{ background:var(--logo); padding:15px; text-align:center; }
header img{ max-width:260px; width:100%; }
.container{ max-width:900px; margin:20px auto; padding:0 15px; }
h2{ color:var(--marrom); display:flex; gap:8px; align-items:center; }
.blocos{ display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:14px; }
.bloco{ background:#fff; padding:16px; border-left:6px solid var(--marrom); border-radius:14px; cursor:pointer; }
</style>
</head>

<body>

<header>
  <img src="../logo.png" alt="S√≠tio C√≥rrego do Pinhal">
</header>

<div id="menu"></div>

<div class="container">

  <h2>üìä Relat√≥rios</h2>

  <div class="blocos">

    <div class="bloco" data-permissao="app.relatorio-financeiro"
         onclick="location.href='../relatorios/relatorio-financeiro.html'">
      üí∞ Financeiro
    </div>

    <div class="bloco" data-permissao="app.relatorio-leite"
         onclick="location.href='../relatorios/relatorio-leite.html'">
      ü•õ Produ√ß√£o de Leite
    </div>

    <div class="bloco" data-permissao="app.relatorio-rebanho"
         onclick="location.href='../relatorios/relatorio-rebanho.html'">
      üêÑ Rebanho
    </div>

    <div class="bloco" data-permissao="app.relatorio-sanitario"
         onclick="location.href='../relatorios/relatorio-sanitario.html'">
      üíâ Sanit√°rio
    </div>

  </div>
</div>

<!-- MENU VISUAL -->
<script>
fetch("../menu/menu.html")
  .then(r => r.text())
  .then(h => document.getElementById("menu").innerHTML = h);
</script>

<!-- FILTRO DOS RELAT√ìRIOS -->
<script>
function filtrarRelatorios(){
  let visivel = false;
  document.querySelectorAll("[data-permissao]").forEach(el=>{
    if (window.temPermissao(el.dataset.permissao)) {
      visivel = true;
    } else {
      el.remove();
    }
  });
  if(!visivel){
    document.querySelector(".blocos").innerHTML =
      "<p style='color:#666'>Nenhum relat√≥rio dispon√≠vel.</p>";
  }
}
if(window.PERMISSOES_USUARIO){
  filtrarRelatorios();
}else{
  document.addEventListener("permissoes-carregadas", filtrarRelatorios, {once:true});
}
</script>

<script src="../login/logout.js"></script>

</body>
</html>