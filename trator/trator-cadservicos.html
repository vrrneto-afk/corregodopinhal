<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cadastro de ServiÃ§os â€“ Trator</title>

<link rel="manifest" href="../manifest.json">
<meta name="theme-color" content="#7b3f2a">

<!-- MENU + FORMS (PADRÃƒO GLOBAL) -->
<link rel="stylesheet" href="../menu/menu.css">

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
if (!firebase.apps.length) {
  firebase.initializeApp({
    apiKey: "AIzaSyCW-CuFDrOLO-dteckl_GrPTocmyS-IrzY",
    authDomain: "sitio-corrego-do-pinhal.firebaseapp.com",
    projectId: "sitio-corrego-do-pinhal"
  });
}
</script>

<script>
window.PERMISSAO_PAGINA = {
  area: "trator",
  chave: "trator-cadservicos"
};
</script>

<script src="../login/auth-guard.js"></script>
</head>

<body style="display:none">

<header>
  <img src="../logo.png">
</header>

<div id="menu"></div>

<div class="container">

<h2>ğŸšœ Cadastro de ServiÃ§os</h2>

<div class="card">

<label>Data do serviÃ§o</label>
<input type="date" id="data">

<label>Cliente</label>
<input type="text" id="cliente">

<label>Tipo de serviÃ§o</label>
<input type="text" id="tipo">

<label>Motorista</label>
<select id="motorista">
  <option value="">Selecione o motorista</option>
</select>

<label>Forma de cobranÃ§a</label>

<div class="radio-group">
  <label class="radio-option">
    <input type="radio" name="cobranca" value="hora" checked>
    <span>Por hora</span>
  </label>
  <label class="radio-option">
    <input type="radio" name="cobranca" value="fechado">
    <span>Valor fechado</span>
  </label>
</div>

<div id="porHora">
  <label>Horas trabalhadas</label>
  <input type="number" id="horas" step="0.1">

  <label>Valor hora trator</label>
  <input type="text" id="valorHora">

  <label>Valor total</label>
  <input type="text" id="valorTotal" readonly>
</div>

<div id="valorFechado" style="display:none">
  <label>Valor total</label>
  <input type="text" id="valorFechadoInput">
</div>

<div id="msg" class="msg"></div>

<div class="actions">
  <button id="excluir" class="btn-secondary" disabled>ğŸ—‘ Excluir</button>
  <button id="salvar" class="btn-primary">ğŸ’¾ Salvar ServiÃ§o</button>
</div>

</div>

<h2>ğŸ“Š ServiÃ§os do mÃªs</h2>

<div class="filters">
  <select id="mes"></select>
  <select id="ano"></select>
</div>

<div class="card table-wrapper">
<table>
<thead>
<tr>
  <th>Data</th>
  <th>Cliente</th>
  <th>Tipo</th>
  <th>Valor</th>
  <th>AÃ§Ãµes</th>
</tr>
</thead>
<tbody id="lista"></tbody>
<tfoot>
<tr>
  <td colspan="3"><strong>Total do mÃªs</strong></td>
  <td id="totalMes">R$ 0,00</td>
  <td></td>
</tr>
</tfoot>
</table>
</div>

<div class="voltar-wrapper">
  <a href="../trator/trator-inicio.html" class="btn-voltar">
    â† Voltar para Trator
  </a>
</div>

</div>

<!-- MENU -->
<script>
fetch("../menu/menu.html")
  .then(r=>r.text())
  .then(html=>{
    menu.innerHTML=html;

    document.querySelectorAll("#menu a").forEach(a=>{
      if(a.getAttribute("href")==="../trator/trator-inicio.html"){
        a.classList.add("ativo");
      }
    });

    const s=document.createElement("script");
    s.src="../menu/menu-permissoes.js";
    document.body.appendChild(s);

    document.body.style.display="block";
  });
</script>

<!-- LÃ“GICA JS (INALTERADA) -->
<script>
/* TODO: permanece exatamente como estava,
   apenas usando DateUtils conforme jÃ¡ ajustado */
</script>

<script src="../login/logout.js"></script>
</body>
</html>